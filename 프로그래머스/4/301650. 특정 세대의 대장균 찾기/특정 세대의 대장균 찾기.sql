# SELECT C.ID
# FROM ECOLI_DATA A INNER JOIN ECOLI_DATA B ON A.ID = B.PARENT_ID
# INNER JOIN ECOLI_DATA C ON B.ID = C.PARENT_ID
# WHERE A.PARENT_ID IS NULL















# SELECT G.ID
# FROM ECOLI_DATA G
# LEFT JOIN ECOLI_DATA P
# ON G.ID = P.PARENT_ID
# WHERE G.PARENT_ID IS NOT NULL


WITH RECURSIVE STAIR (GENERATION, ID) AS (
    SELECT 1 AS GENERATION, ID
    FROM ECOLI_DATA
    WHERE PARENT_ID IS NULL

    UNION ALL

    SELECT S.GENERATION + 1, E.ID
    FROM ECOLI_DATA E
    JOIN STAIR S ON E.PARENT_ID = S.ID
)

SELECT ID
FROM STAIR
WHERE GENERATION = 3
ORDER BY ID;
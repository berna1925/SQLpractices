WITH MAX_SIZES AS (
    SELECT I.FISH_TYPE, MAX(LENGTH) AS MAX_SIZE
    FROM FISH_INFO I
    WHERE LENGTH IS NOT NULL
    # 문제에서 NULL인 경우의 수를 빼라고 했는데 빼지 않아 풀지 못했음
    GROUP BY I.FISH_TYPE
    )

SELECT DISTINCT ID, FISH_NAME, LENGTH
FROM FISH_INFO I JOIN FISH_NAME_INFO N ON I.FISH_TYPE = N.FISH_TYPE
JOIN MAX_SIZES M ON I.FISH_TYPE = M.FISH_TYPE
    # 그룹과 길이 데이터가 있으면 그룹으로 링크 기준을 삼는 게 상식적인데 그렇게 하지 않고 길이로 기준을 삼는 기행을 벌였음..
WHERE LENGTH = M.MAX_SIZE
ORDER BY ID ;

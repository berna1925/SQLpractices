# 2025-07-29 19:30 내 의견 80% GPT 20%
# WITH 절에서는 임시테이블 이름을 만들 때 소괄호 안에 칼럼명을 명시할 수 있다
# 가끔 칼럼명과 칼럼 내부 자료 형태가 어그러질 때가 있어 혼동될 수 있으므로 명시하는 게 낫다고 한다
# 그래도 재귀문을 쓸 생각을 한 것, 부모를 1세대로 지정해 꼭 3세대만을 빼올 수 있게 한 발상이 좋았다
    
WITH RECURSIVE STAIR (GENERATION, ID) AS (
    SELECT 1 AS GENERATION, ID
    FROM ECOLI_DATA
    WHERE PARENT_ID IS NULL

    UNION ALL

    SELECT S.GENERATION + 1, E.ID
    FROM ECOLI_DATA E
    JOIN STAIR S ON E.PARENT_ID = S.ID
)

SELECT ID
FROM STAIR
WHERE GENERATION = 3
ORDER BY ID;










# SELECT C.ID
# FROM ECOLI_DATA A INNER JOIN ECOLI_DATA B ON A.ID = B.PARENT_ID
# INNER JOIN ECOLI_DATA C ON B.ID = C.PARENT_ID
# WHERE A.PARENT_ID IS NULL















# SELECT G.ID
# FROM ECOLI_DATA G
# LEFT JOIN ECOLI_DATA P
# ON G.ID = P.PARENT_ID
# WHERE G.PARENT_ID IS NOT NULL


